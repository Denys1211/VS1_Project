<template name="contact_card">
  <style>
    .results tr[visible='false'],
    .no-result {
      display: none;
    }

    .results tr[visible='true'] {
      display: table-row;
    }

    .counter {
      padding: 8px;
      color: #ccc;
    }

    .sideSearch {
      /*width: 200px;*/
      overflow-x: hidden;
      overflow-y: hidden;
    }

    .cardB {
      /* max-height: 700px; */
      overflow-y: auto;
    }

    .cardB420 {
      max-height: 300px;
      overflow-y: auto;
    }

    .rowB {
      overflow-x: auto;
    }

    .nav-tabs .nav-link.active {
      color: rgb(0, 163, 211) !important;
      background-color: #EDEDED !important;
      border-color: #00a3d3 #00a3d3 #ededed #00a3d3 !important;
    }

    .nav-tabs .nav-link {
      background-color: #fff !important;
      border-color: #00a3d3 !important;
    }

    @media only screen and (max-width: 600px) {
      .sideSearch {
        width: auto;
      }
    }

    #btnView {
      display: none;
    }

    @media screen and (min-width: 1025px) {
      .viewList {
        display: none;
      }

      .displayList {
        height: 115vh;
      }

      .customerCardParent {
        height: 100%;
      }
    }

    .currentSelect {
      background-color: #ededed99;
      color: #00a3d3;
    }

    @media screen and (max-width: 450px) {
      .sideSearch {
        height: 400px !important;
        overflow-y: scroll;
      }
    }
  </style>
  <div>
    <div class="fullScreenSpin d-none">
      <div class="spinner"></div>
    </div>
    {{#if record}}
    <div style="margin: 16px;">
      {{#unless isModal}}
      <div class="row">
        <div class="col-12 col-md-4">
          <h2 class="text-dark mb-0">Customer Overview Dashboard
            {{> helpbutton}}
          </h2>
        </div>
        <div class="col-12 col-md-4">{{> loggedcompanyoverview}}</div>
      </div>
      {{/unless}}
      <div class="row">
  
        {{#unless isModal}}
        <div class="col-12 col-md-4 col-lg-2 displayList" id="displayList">
          <div class="card shadow mb-4 customerCardParent" style="margin: 8px;">
            <div class="card-header d-flex justify-content-between align-items-center">
              <h6 class="text-primary font-weight-bold m-0">Customers</h6>
              <div class="dropdown no-arrow">
                <button class="btn btn-link dropdown-toggle" data-toggle="dropdown" aria-expanded="false" type="button">
                  <i class="fas fa-ellipsis-v text-gray-400"></i>
                </button>
                <div class="dropdown-menu shadow dropdown-menu-right animated--fade-in" role="menu">
                  <p class="text-center dropdown-header">Customer List</p>
                  <a class="dropdown-item btnNewCustomer" role="presentation" href="#">
                    &nbsp;+ New Customer
                  </a>
                </div>
              </div>
            </div>
            <div class="card-body text-nowrap cardB customerListCard" id="customerListCard">
              <div class="sideSearch">
                <div class="row">
                  <div class="col-12" style="display: inline-flex;">
                    <input type="text" class="search form-control txtSearchCustomers" placeholder="Search..."
                      style="width: 80%;">
                    <button class="btn btn-primary btnRefreshCustomers" type="button" id="btnRefreshCustomers"
                      style="padding: 4px 10px; font-size: 16px; margin-left: 12px !important;" autocomplete="off">
                      <i class="fas fa-search-plus"></i>
                    </button>
                  </div>
                  <div class="col-12">
                    <span class="pull-right">{{customerrecords.length}} items</span>
                  </div>
                  <div class="col-12">
                    <table id="tblCustomerSideList" name="tblCustomerSideList"
                      class="table table-hover table-bordered results tblCustomerSideList">
                      <thead>
                        <tr>
                          <th>Customer</th>
                        </tr>
                        <tr class="warning no-result">
                          <td colspan="4"><i class="fa fa-warning"></i> No result</td>
                        </tr>
                      </thead>
                      <tbody>
                        {{#if customerrecords}}
                        {{#each item in customerrecords}}
                        <tr id="{{item.id}}" class="{{item.isslectJob}}" style="cursor: pointer;">
                          <td data-toggle="tooltip" data-bs-tooltip="" data-placement="bottom" title="{{item.company}}"
                            id="{{item.id}}" class="{{item.isslectJob}} {{item.classname}}">{{item.company}}
                          </td>
                        </tr>
                        {{/each}}
                        {{/if}}
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        {{/unless}}
        <div class="{{#if isModal}}{{else}}col-12 col-md-8 col-lg-10 displayInfo{{/if}}" id="displayInfo"
          style="padding-top: 8px; width: 100%;">
          <!-- All Cards List -->
          {{#if isModal}}

          {{else}}
          {{> editCardChartButtons}}
          {{> allCardsLists tabGroupID="9" chartGroup="PaymentOverviewCustomer"}}
          {{/if}}
          <div class="card shadow mb-4 cardSizing">
            {{> vs1_contact_card_header isJob=isJob record=record id="customerInfo"}}
            {{> customfieldDroppop}}
            {{> customfieldpop}}
            <div class="card-body text-nowrap">
              <div>
                <ul class="nav nav-tabs nav-fill">
                  {{# if isJob}}
                  <li class="nav-item" style="cursor: pointer;">
                    <a class="nav-link mainTab jobTab active" role="tab" data-toggle="tab" data-target="#tab-Job"
                      data-id="tab-job">
                      Job Details
                    </a>
                  </li>
                  {{else}}
                  <li class="nav-item" style="cursor: pointer;">
                    <a class="nav-link mainTab customerTab active" role="tab" data-toggle="tab" data-target="#tab-2"
                      data-id="tab-2">
                      Customer Details
                    </a>
                  </li>
                  <li class="nav-item" style="cursor: pointer;">
                    <a class="nav-link mainTab jobTab" role="tab" data-toggle="tab" data-target="#tab-3"
                      data-id="tab-3">
                      Job Details
                    </a>
                  </li>
                  {{/if}}
                  <li class="nav-item" style="cursor: pointer;">
                    <a class="nav-link mainTab transactionTab" role="tab" data-toggle="tab" data-target="#tab-1"
                      data-id="tab-1">
                      Transaction List
                    </a>
                  </li>
                </ul>
                <div class="tab-content">
                  <style>
                    .table-responsive {
                      overflow-x: auto;
                    }

                    @media only screen and (max-width: 1920px) {
                      .tab-1 {
                        width: 100%;
                      }

                      .tab-2 {
                        width: 100%;
                      }

                      .tab-3 {
                        width: 100%;
                      }
                    }

                    @media only screen and (max-width: 1600px) {
                      .tab-1 {
                        width: 100%;
                      }

                      .tab-2 {
                        width: 100%;
                      }

                      .tab-3 {
                        width: 100%;
                      }
                    }

                    @media only screen and (max-width: 1536px) {
                      .tab-1 {
                        width: 100%;
                      }

                      .tab-2 {
                        width: 100%;
                      }

                      .tab-3 {
                        width: 100%;
                      }
                    }

                    @media only screen and (max-width: 1367px) {
                      .tab-1 {
                        width: 100%;
                      }

                      .tab-2 {
                        width: 100%;
                      }

                      .tab-3 {
                        width: 100%;
                      }
                    }
                  </style>
                  <!-- start Job -->
                  {{# if isJob}}
                  <div class="tab-pane active border rounded-0 tab-Job jobTabEdit" role="tabpanel" id="tab-Job"
                    style="background-color: #ededed; border-color: #ededed #00a3d3 #00a3d3 #00a3d3 !important;">
                    {{#if equals currentTab 'tab-job'}}
                    <div class="row d-xl-flex flex-column justify-content-xl-center" style="margin: 12px;">
                      <div class="col">
                        <div class="row">
                          {{#each item in tableheaderrecords}}
                          {{> default_input
                          label=item.label
                          divClass=item.divClass
                          id= item.id
                          jobdivClass=item.jobdivClass
                          isjobelement= true
                          name=item.name
                          readonly=item.readonly
                          }}
                          {{/each}}
                        </div>
                      </div>
                      <div class="col" style="padding: 4px;margin-top: 16px;">
                        <div>
                          <ul class="nav nav-tabs nav-justified">
                            <li class="nav-item" style="cursor: pointer;"><a class="nav-link crmTab active" role="tab"
                                data-toggle="tab" data-target="#tab-crm-job">CRM</a></li>
                            <li class="nav-item"><a class="nav-link" role="tab" data-toggle="tab"
                                data-target="#tab-Job4">Address</a>
                            </li>
                            <li class="nav-item"><a class="nav-link" role="tab" data-toggle="tab"
                                data-target="#tab-Job5">Notes</a></li>
                            <li class="nav-item"><a class="nav-link" role="tab" data-toggle="tab"
                                data-target="#tab-Job6">Invoicing</a>
                            </li>
                            <li class="nav-item attachmentTabJobNoPOP"><a class="nav-link" role="tab" data-toggle="tab"
                                data-target="#tab-Job8">{{#if
                                attachmentCountJobNoPOP}}<span
                                  id="attachment-count">{{attachmentCountJobNoPOP}}</span>{{/if}}
                                Attachments</a></li>
                            <li class="nav-item"><a class="nav-link" role="tab" data-toggle="tab"
                                data-target="#tab-Job10">Tax</a></li>
                          </ul>

                          <div class="tab-content">
                            <div class="tab-pane border rounded-0 tab-crm active" role="tabpanel" id="tab-crm-job"
                              style="border-color: #ededed #00a3d3 #00a3d3 #00a3d3 !important;padding: 20px;">
                              <style>
                                #tblCustomerCrmListWithDate {
                                  width: 100% !important;
                                }

                                #tblCustomerCrmListWithDate .colDate {
                                  width: 12% !important;
                                }

                                #tblCustomerCrmListWithDate .colType {
                                  width: 12% !important;
                                }

                                #tblCustomerCrmListWithDate .colTaskName {
                                  width: 18% !important;
                                }

                                #tblCustomerCrmListWithDate .colTaskDesc {
                                  width: 30% !important;
                                }

                                #tblCustomerCrmListWithDate .colCompletedBy {
                                  width: 15% !important;
                                }

                                #tblCustomerCrmListWithDate .colCompleteTask {
                                  width: 12% !important;
                                }
                              </style>
                              <!--                              {{> non_transactional_list tablename="tblCustomerCrmListWithDate"}}-->
                              {{>datatablelist
                              tablename="tblCustomerCrmListWithDate"
                              apiName= apiFunction
                              indexeddbname = 'TCRMTaskList'
                              tableheaderrecords = tableheaderrecords
                              exportfilename = 'Customer CRM Task List'
                              istransaction = true
                              apiParams= apiParams
                              datahandler = datahandler
                              service=service
                              lowercaseDataName='tprojecttaskslist'
                              exIndexDBName = 'tprojecttaskslist'
                              exdatahandler = exDataHandler
                              searchAPI = searchAPI
                              }}
                            </div>
                            <div class="tab-pane border rounded-0 tab-Job4" role="tabpanel" id="tab-Job4"
                              style="border-color: #ededed #00a3d3 #00a3d3 #00a3d3 !important;overflow: auto;">
                              <div class="row" style="margin: 4px 12px;">
                                <div class="col-12" style="padding: 0;">
                                  <h4 style="margin: 4px;">Shipping Address</h4>
                                </div>
                              </div>
                              <div class="row" style="margin: 4px 12px;">
                                <div class="col-12 col-md-6" style="padding: 0;">
                                  <div class="form-group" style="margin: 4px;">
                                    <label>Street Address</label><textarea class="form-control" style="height: 116px;"
                                      rows="4" id="edtJobCustomerShippingAddress" name="edtJobCustomerShippingAddress"
                                      value="{{record.jobshippingaddress}}"></textarea>
                                  </div>
                                </div>
                                <div class="col-12 col-md-6">
                                  <div class="row">
                                    <div class="col-6" style="padding: 0;">
                                      <div class="form-group" style="margin: 4px;"><label>City /
                                          Town</label><input type="text" class="form-control"
                                          id="edtJobCustomerShippingCity" name="edtJobCustomerShippingCity"
                                          value="{{record.jobscity}}"></div>
                                    </div>
                                    <div class="col-6" style="padding: 0;">
                                      <div class="form-group" style="margin: 4px;"><label>State /
                                          Region</label><input type="text" class="form-control"
                                          id="edtJobCustomerShippingState" name="edtJobCustomerShippingState"
                                          value="{{record.jobsstate}}"></div>
                                    </div>
                                    <div class="col-6" style="padding: 0;">
                                      <div class="form-group" style="margin: 4px;"><label>ZIP
                                          Code</label><input type="text" class="form-control"
                                          id="edtJobCustomerShippingZIP" name="edtJobCustomerShippingZIP"
                                          value="{{record.jobspostalcode}}">
                                      </div>
                                    </div>
                                    <div class="col-6" style="padding: 0;">
                                      <div class="form-group" style="margin: 4px;">
                                        <label>Country</label><select class="form-control" id="sedtJobCountry"
                                          name="sedtJobCountry">
                                          {{#each item in countryList}}
                                          {{#if equals item record.jobscountry
                                          }}
                                          <option value="{{record.jobscountry}}" selected="">
                                            {{record.jobscountry}}
                                          </option>
                                          {{else}}
                                          <option value="{{item}}">{{item}}
                                          </option>
                                          {{/if}}
                                          {{/each}}
                                        </select>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <div class="row no-gutters flex-column" style="margin: 12px;">
                                <style>
                                  .jobbillingaddress {
                                    display: none;
                                  }
                                </style>
                                <script>
                                  function myFunctionJob() {
                                    const checkBoxJob = document.getElementById("chkJobSameAsShipping2");
                                    const billingAddressJob = document.getElementById("jobbillingaddress");
                                    if (checkBoxJob.checked === true) {
                                      billingAddressJob.style.display = "none";
                                    } else {
                                      billingAddressJob.style.display = "flex";
                                    }
                                  }
                                </script>
                                <div class="col">
                                  <div class="row no-gutters" style="margin-top: 12px;">
                                    <div class="col d-xl-flex align-items-start" style="padding: 0;">
                                      <h4 class="flex-grow" style="margin: 4px;">
                                        Billing Address</h4>
                                      <div class="custom-control custom-switch chkJobaddress" style="margin: 8px;">
                                        <input class="custom-control-input" type="checkbox" id="chkJobSameAsShipping2"
                                          onclick="myFunctionJob()" checked><label class="custom-control-label"
                                          for="chkJobSameAsShipping2">Same as
                                          Shipping</label>
                                      </div>
                                    </div>
                                    {{#if equals isJobSameAddress true}}
                                    <script>
                                      $('#chkJobSameAsShipping2').attr("checked", "checked");
                                      $('#jobbillingaddress').css("display", "none");
                                    </script>
                                    {{else}}
                                    <script>
                                      $('#chkJobSameAsShipping2').removeAttr("checked");
                                      $('#jobbillingaddress').css("display", "flex");
                                    </script>
                                    {{/if}}
                                  </div>
                                  <div class="row jobbillingaddress" id="jobbillingaddress" style="margin: 4px 12px;">
                                    <div class="col-12 col-md-6" style="padding: 0;">
                                      <div class="form-group" style="margin: 4px;"><label>Street
                                          Address</label><textarea class="form-control"
                                          style="width: 100%;height: 116px;" rows="4" id="edtCustomerBillingAddress"
                                          name="edtCustomerBillingAddress"
                                          value="{{record.jobbillingaddress}}"></textarea>
                                      </div>
                                    </div>
                                    <div class="col-12 col-md-6">
                                      <div class="row">
                                        <div class="col-6" style="padding: 0;">
                                          <div class="form-group" style="margin: 4px;"><label>City
                                              / Town</label><input type="text" class="form-control"
                                              id="edtJobCustomerBillingCity" name="edtJobCustomerBillingCity"
                                              value="{{record.jobbcity}}">
                                          </div>
                                        </div>
                                        <div class="col-6" style="padding: 0;">
                                          <div class="form-group" style="margin: 4px;">
                                            <label>State /
                                              Region</label><input type="text" class="form-control"
                                              id="edtJobCustomerBillingState" name="edtJobCustomerBillingState"
                                              value="{{record.jobbstate}}">
                                          </div>
                                        </div>
                                        <div class="col-6" style="padding: 0;">
                                          <div class="form-group" style="margin: 4px;"><label>ZIP
                                              Code</label><input type="text" class="form-control"
                                              id="edtJobCustomerBillingZIP" name="edtJobCustomerBillingZIP"
                                              value="{{record.jobbpostalcode}}">
                                          </div>
                                        </div>
                                        <div class="col-6" style="padding: 0;">
                                          <div class="form-group" style="margin: 4px;">
                                            <label>Country</label><select class="form-control" id="sJobedtCountry"
                                              name="sJobedtCountry">
                                              {{#each item in
                                              countryList}}
                                              {{#if equals item
                                              record.jobbcountry }}
                                              <option value="{{record.jobbcountry}}" selected="">
                                                {{record.jobbcountry}}
                                              </option>
                                              {{else}}
                                              <option value="{{item}}">
                                                {{item}}</option>
                                              {{/if}}
                                              {{/each}}
                                            </select>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="tab-pane border rounded-0 tab-Job5" role="tabpanel" id="tab-Job5"
                              style="border-color: #ededed #00a3d3 #00a3d3 #00a3d3 !important;">
                              <div class="row no-gutters" style="margin: 12px;">
                                <div class="col">
                                  <div
                                    class="form-group d-flex d-sm-flex d-xl-flex flex-column flex-grow-1 align-items-start align-items-sm-start align-items-xl-start"
                                    style="margin: 4px;"><label>Notes</label>
                                    <textarea class="border rounded flex-grow-1" style="width: 100%;height: 116px;"
                                      rows="4" id="txaJobNotes" name="txaJobNotes">{{record.jobnotes}}</textarea>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="tab-pane border rounded-0 tab-Job6" role="tabpanel" id="tab-Job6"
                              style="border-color: #ededed #00a3d3 #00a3d3 #00a3d3 !important;">
                              <div class="row no-gutters d-xl-flex flex-column justify-content-xl-start"
                                style="margin: 12px;">
                                <div class="col d-xl-flex align-items-xl-end">
                                  <div class="form-group d-xl-flex flex-column justify-content-xl-start"
                                    style="margin: 4px;padding-right:4px;"><label class="text-nowrap">Customer
                                      Type</label>

                                    <select type="search" class="form-control" id="sltJobCustomerType"
                                      value="{{record.clienttype}}" name="sltJobCustomerType"
                                      style="background-color:rgb(255, 255, 255); cursor: pointer;">
                                    </select>

                                  </div>

                                  <div class="form-group d-xl-flex flex-column align-items-xl-start"
                                    style="margin: 4px;padding-left:4px;"><label class="text-nowrap">Preferred Payment
                                      Method</label>
                                    <select type="search" class="form-control" id="sltJobPreferredPayment"
                                      name="sltJobPreferredPayment" value="{{record.preferedpayment}}"
                                      style="background-color:rgb(255, 255, 255); cursor: pointer;">
                                    </select>
                                  </div>
                                  <div class="form-group d-xl-flex flex-column justify-content-xl-start"
                                    style="margin: 4px; padding-left:4px;"><label class="text-nowrap">Terms</label>
                                    <select type="search" class="form-control" id="sltJobTerms" name="sltJobTerms"
                                      value="{{record.jobterms}}"
                                      style="background-color:rgb(255, 255, 255); cursor: pointer;">
                                    </select>
                                  </div>

                                  <div class="form-group d-xl-flex flex-column justify-content-xl-start"
                                    style="margin: 4px; disply:none;"><label class="text-nowrap">% Discount</label>
                                    <input type="text" class="form-control pointer" id="edtJobCustomerCardDiscount"
                                      name="edtJobCustomerCardDiscount" value="{{record.jobdiscount}}">
                                  </div>
                                </div>
                                <div class="col d-xl-flex align-items-xl-end" style="display:none!important;">
                                  <div class="form-group d-xl-flex flex-column justify-content-xl-start"
                                    style="margin: 4px;"><label class="text-nowrap">Preferred Delivery
                                      Method</label>
                                    <select class="form-control" style="width: 260px;" id="sltJobDeliveryMethod"
                                      name="sltJobDeliveryMethod">
                                      {{#each item in deliveryMethodList}}
                                      {{#if equals item record.deliverymethod }}
                                      <option value="{{record.jobdeliverymethod}}" selected="">
                                        {{record.jobdeliverymethod}}
                                      </option>
                                      {{else}}
                                      <option value="{{item}}">{{item}}</option>
                                      {{/if}}
                                      {{/each}}
                                    </select>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="tab-pane border rounded-0 tab-Job8" role="tabpanel" id="tab-Job8"
                              style="border-color: #ededed #00a3d3 #00a3d3 #00a3d3 !important;">
                              <div class="row no-gutters" style="margin: 12px;">
                                <div class="col">
                                  <style>
                                    .file-nameJobNoPOP span {
                                      width: 100%;
                                      float: left;
                                    }

                                    #file-displayJobNoPOP .fileIocns i.fa.fa-file {
                                      color: rgb(252, 181, 38);
                                      font-size: 24px;
                                    }

                                    #file-displayJobNoPOP {
                                      padding: 0;
                                      margin: 0;
                                    }

                                    .uploaded-elementJobNoPOP .confirm-actionJobNoPOP a.confirm-delete-attachmentJobNoPOP {
                                      padding: 6px 13px 5px;
                                      background-color: rgb(216, 68, 68) !important;
                                      border-color: rgb(197, 112, 119) rgb(169, 29, 29) rgb(169, 29, 29) rgb(197, 112, 119);
                                      color: rgb(255, 255, 255) !important;
                                      text-shadow: 1px 1px 1px rgba(30, 30, 30, 0.15);
                                      line-height: initial;
                                      font-size: 12px;
                                      float: left;
                                    }

                                    /* HERE */
                                    #files_viewJobNoPOP .modal-title {
                                      white-space: nowrap;
                                      overflow: hidden;
                                      text-overflow: ellipsis;
                                      width: 70%;
                                    }

                                    #files_viewJobNoPOP .modal-title {
                                      color: #333;
                                      font-size: 18px;
                                      font-weight: 700;
                                      text-rendering: optimizelegibility;
                                      padding: 9px 0;
                                      padding-left: 15px;
                                      padding-top: 11px;
                                    }

                                    #files_viewJobNoPOP .modal-dialog {
                                      width: 750px;
                                      margin: 30px auto;
                                    }

                                    #files_viewJobNoPOP .modal-header .close {
                                      margin-top: 0;
                                      width: 46px;
                                      height: 46px;
                                      padding: 6px 0 0;
                                      border-left: 1px solid #ddd;
                                      opacity: 1;
                                      margin: 0;
                                    }

                                    #files_viewJobNoPOP .modal-header {
                                      padding: 0;
                                      display: block;
                                    }

                                    #files_viewJobNoPOP .modal-body {
                                      background-color: rgb(250, 251, 251);
                                    }

                                    #files_viewJobNoPOP .image-previewer img {
                                      border: 3px solid #fff;
                                      box-shadow: 2px 2px 8px rgba(0, 0, 0, .2);
                                      width: 100%;
                                    }

                                    .download_buttonJobNoPOP {
                                      width: 100%;
                                      text-align: center;
                                      margin-top: 20px;
                                    }
                                  </style>
                                  <!-- Start Attachemt -->
                                  <div class="divTable" id="file-displayJobNoPOP">
                                    <div class="col inboxcol1">
                                      <img src="/icons/nofiles_icon.png" class="">
                                    </div>
                                    <div class="col inboxcol2">
                                      <div>Upload files or add files from the file
                                        library</div>
                                      <p style="color: #ababab;">Only users with
                                        access to your company can view these
                                        files</p>
                                    </div>
                                  </div>

                                  <input type="file" id="attachment-uploadJobNoPOP" style="display:none" multiple
                                    accept="image/*;capture=camera,.jpg,.gif,.png,.bmp,.tiff,.pdf,.doc,.docx,.xls,.xlsx,.ppt,
                                                                            .pptx,.odf,.csv,.txt,.rtf,.eml,.msg,.ods,.odt,.keynote,.key,.pages-tef,
                                                                            .pages,.numbers-tef,.numbers,.zip,.rar,.zipx,.xzip,.7z,image/jpeg,
                                                                            image/gif,image/png,image/bmp,image/tiff,application/pdf,
                                                                            application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,
                                                                            application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,
                                                                            application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation,
                                                                            application/vnd.oasis.opendocument.formula,text/csv,text/plain,text/rtf,message/rfc822,
                                                                            application/vnd.ms-outlook,application/vnd.oasis.opendocument.spreadsheet,
                                                                            application/vnd.oasis.opendocument.text,application/x-iwork-keynote-sffkey,
                                                                            application/vnd.apple.keynote,application/x-iwork-pages-sffpages,
                                                                            application/vnd.apple.pages,application/x-iwork-numbers-sffnumbers,
                                                                            application/vnd.apple.numbers,application/zip,application/rar,
                                                                            application/x-zip-compressed,application/x-zip,application/x-7z-compressed">
                                  <button class="btn btn-primary btnUploadFileJobNoPOP new_attachment_btnJobNoPOP"
                                    type="button" style="margin: 4px;"><i class="fa fa-cloud-upload"
                                      style="margin-right: 5px;"></i>Upload</button>
                                  <!-- END Attachments -->
                                </div>
                              </div>
                            </div>

                            <!-- View File Attachemt -->
                            <div id="files_viewJobNoPOP" class="modal fade" role="dialog">
                              <div class="modal-dialog">
                                <!-- Modal content-->
                                <div class="modal-content">
                                  <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal">x</button>
                                    <h4 class="modal-title">
                                      {{uploadedFileJobNoPOP.name}}</h4>
                                  </div>
                                  <div class="modal-body">
                                    {{#if uploadedFileJobNoPOP.image}}
                                    <div class="image-previewer">
                                      <img src="{{uploadedFileJobNoPOP.link}}">
                                    </div>
                                    {{else}}
                                    <div class=" default-file {{uploadedFileJobNoPOP.class}}">

                                    </div>
                                    {{/if}}
                                    <div class="download_buttonJobNoPOP">
                                      <a class="new_create_btn btn btn-primary" id="downloadButtonJobNoPOP"
                                        download="{{uploadedFileJobNoPOP.name}}"
                                        href="{{uploadedFileJobNoPOP.link}}">Download</a>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <!-- End View File attachment -->

                            <div class="tab-pane border rounded-0 tab-Job9" role="tabpanel" id="tab-Job9"
                              style="border-color: #ededed #00a3d3 #00a3d3 #00a3d3 !important;">
                              <div class="row no-gutters" style="margin: 12px;">
                                <div class="col d-xl-flex align-items-xl-center">
                                  <div class="form-group flex-grow-1" style="margin: 4px;"><label class="text-nowrap"
                                      contenteditable="true">Custom Field
                                      1</label><input type="text" class="form-control" id="edtJobCustomeField1"
                                      name="edtJobCustomeField1" value="{{record.jobcustfield1}}"></div>
                                  <div class="form-group flex-grow-1" style="margin: 4px;"><label class="text-nowrap"
                                      contenteditable="true">Custom Field
                                      2</label><input type="text" class="form-control" id="edtJobCustomeField2"
                                      name="edtJobCustomeField2" value="{{record.jobcustfield2}}"></div>
                                  <div class="form-group flex-grow-1" style="margin: 4px;"><label class="text-nowrap"
                                      contenteditable="true">Custom Field
                                      3</label><input type="text" class="form-control" id="edtJobCustomeField3"
                                      name="edtJobCustomeField3" value="{{record.jobcustfield3}}"></div>
                                  <div class="form-group flex-grow-1" style="margin: 4px;"><label class="text-nowrap"
                                      contenteditable="true">Custom Field
                                      4</label><input type="text" class="form-control" id="edtJobCustomeField4"
                                      name="edtJobCustomeField4" value="{{record.jobcustfield4}}"></div>
                                </div>
                              </div>
                            </div>
                            <div class="tab-pane border rounded-0 tab-Job10" role="tabpanel" id="tab-Job10"
                              style="border-color: #ededed #00a3d3 #00a3d3 #00a3d3 !important;">
                              <div class="row no-gutters d-xl-flex flex-column justify-content-xl-start"
                                style="margin: 12px;">
                                <div class="col">
                                  <div class="custom-control custom-switch" style="margin: 4px;"><input
                                      class="custom-control-input" type="checkbox" id="formCheckJob-2" checked><label
                                      class="custom-control-label" for="formCheckJob-2">This customer is tax
                                      exempt</label></div>
                                </div>

                                {{#if equals record.jobtaxcode "NT"}}
                                <script>
                                  $('#formCheckJob-2').attr("checked", "checked");
                                  $('#autoUpdateJob').css('display', 'none');
                                </script>
                                {{else}}
                                <script>
                                  $('#formCheckJob-2').removeAttr("checked");
                                  $('#autoUpdateJob').css('display', 'block');
                                </script>
                                {{/if}}

                                <div class="col d-xl-flex align-items-xl-end">
                                  <div id="autoUpdateJob" style="display: none;">
                                    <div
                                      class="form-group d-flex d-sm-flex d-xl-flex flex-column flex-grow-1 align-items-start align-items-sm-start align-items-xl-start"
                                      style="margin: 4px;"><label class="text-nowrap">Tax
                                        Code</label>
                                      <select type="search" class="form-control" value="{{record.jobtaxcode}}"
                                        style="width: 260px; background-color:rgb(255, 255, 255); cursor: pointer;"
                                        id="sltJobTaxCode" name="sltJobTaxCode">
                                      </select>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="d-xl-flex justify-content-between align-items-xl-center"
                        style="margin: 16px 0px 0px 0px;">
                        <button class="btn btn-success btnSaveJob" type="button"><i class="fa fa-save"
                            style="margin-right: 5px;"></i>Save</button>
                        <div>
                          <button class="btn btn-warning btnJobTask" type="button"><i class="fas fa-plus"
                              style="margin-right: 5px;"></i>Task</button>
                          <button class="btn btn-primary btnJobEmail" type="button"><i class="fas fa-plus"
                              style="margin-right: 5px;"></i>Email</button>
                          <button class="btn btn-success btnJobAppointment" type="button"><i class="fas fa-plus"
                              style="margin-right: 5px;"></i>Appointment</button>
                          <button class="btn btn-info btnJobQuote" type="button"><i class="fas fa-plus"
                              style="margin-right: 5px;"></i>Quote</button>
                          <button class="btn btn-warning btnJobSalesOrder" type="button"><i class="fas fa-plus"
                              style="margin-right: 5px;"></i>Sales
                            Order</button>
                          <button class="btn btn-primary btnJobInvoice" type="button"><i class="fas fa-plus"
                              style="margin-right: 5px;"></i>Invoice</button>
                          <button class="btn btn-success btnJobRefund" type="button"><i class="fas fa-plus"
                              style="margin-right: 5px;"></i>Refund</button>
                        </div>
                        <button class="btn btn-secondary btnBack" type="button"><i class="fa fa-close"
                            style="margin-right: 5px;"></i>Cancel</button>
                      </div>
                    </div>
                    {{/if}}
                  </div>
                  {{else}}
                  <!-- end job -->
                  <div class="tab-pane active border rounded-0 tab-2" role="tabpanel" id="tab-2"
                    style="background-color: #ededed; border-color: #ededed #00a3d3 #00a3d3 #00a3d3 !important;">
                    {{#if equals currentTab 'tab-2'}}
                    <div class="row d-xl-flex flex-column justify-content-xl-center" style="margin: 12px;">
                      <div class="col">
                        <div class="row">
                          {{#each item in tableheaderrecords}}
                          {{#if equals item.id 'edtSalesQuota'}}
                          <div class="form-group col-md-2" style="padding-left :4px;padding-right:4px;">
                            <label>Sales Quota</label>
                            <input type="text" class="form-control" id="edtSalesQuota" name="edtSalesQuota"
                              value="{{formatPrice record.salesQuota}}"
                              title="Displays as Rev Counter on Sales Manager Dashboard">
                          </div>

                          {{else if equals item.type 'search'}}
                          <div class="form-group {{item.divClass}}">
                            {{>vs1___dropdown
                            type='search'
                            id=item.id
                            name=item.id
                            modalId= item.listModalId
                            list_template_name=item.listModalTemp
                            innerModal= item.innermodal
                            modal_title=item.modalTitle
                            label = item.label
                            colNameForValue = item.colName
                            target_modal_id= item.editModalId
                            target_template_id=item.editModalTemp
                            is_editable=item.editable
                            }}
                          </div>
                          {{else}}
                          {{> default_input
                          label=item.label
                          divClass=item.divClass
                          id=item.id
                          name=item.name
                          readonly=item.readonly
                          }}
                          {{/if}}
                          {{/each}}
                          <div class="form-group col-md-2" style="margin: 4px;padding-left:4px;padding-right:4px;">
                            <label for="leadSource">Source</label>
                            <select class="form-control" id="leadSource" value="{{record.source}}">
                              <option>Unknown</option>
                              <option>Google</option>
                              <option>Phone</option>
                              <option>Search Engine</option>
                            </select>
                          </div>
                          <style>
                            @media (max-width: 420px) {
                              .chkSameSupplier {
                                margin-top: 20px !important;
                              }
                            }
                          </style>
                          <div class="custom-control custom-switch chkSameSupplier col-md-2"
                            style="margin: 4px; margin-top: 41px;">
                            <input class="custom-control-input" type="checkbox" id="chkSameAsSupplier"
                              style=" cursor: pointer;" checked="{{#if record.issupplier}}checked{{/if}}">
                            <label class="custom-control-label" for="chkSameAsSupplier" style=" cursor: pointer;">Is
                              Also Supplier</label>
                          </div>
                        </div>
                      </div>
                      <div class="col" style="padding: 4px;margin-top: 16px;">
                        <div>
                          <ul class="nav nav-tabs nav-justified">
                            <li class="nav-item" style="cursor: pointer;"><a class="nav-link crmTab active" role="tab"
                                data-toggle="tab" data-target="#tab-crm">CRM</a></li>
                            <li class="nav-item" style="cursor: pointer;"><a class="nav-link" role="tab"
                                data-toggle="tab" data-target="#tab-4">Address</a></li>
                            <li class="nav-item" style="cursor: pointer;"><a class="nav-link" role="tab"
                                data-toggle="tab" data-target="#tab-5">Notes</a></li>
                            <li class="nav-item" style="cursor: pointer;"><a class="nav-link bilingTab" role="tab"
                                data-toggle="tab" data-target="#tab-6">Invoicing</a></li>
                            {{#if record.issupplier}}
                            <!-- <li class="nav-item" style="cursor: pointer;"><a class="nav-link bilingTab" role="tab"
                                  data-toggle="tab" data-target="#tab-7">Billing</a></li> -->
                            {{/if}}
                            <li class="nav-item attachmentTab" style="cursor: pointer;"><a class="nav-link" role="tab"
                                data-toggle="tab" data-target="#tab-8">{{#if attachmentCount}}<span
                                  id="attachment-count">{{attachmentCount}}</span>{{/if}}
                                Attachments</a></li>
                            <li class="nav-item" style="cursor: pointer;"><a class="nav-link" role="tab"
                                data-toggle="tab" data-target="#tab-9">Custom Fields</a></li>
                            <li class="nav-item" style="cursor: pointer;"><a class="nav-link taxTab" role="tab"
                                data-toggle="tab" data-target="#tab-10">Tax</a></li>
                          </ul>
                          <script>
                            setTimeout(function () {
                              const x = window.matchMedia("(max-width: 420px)");

                              function mediaQuery(x) {
                                if (x.matches) {
                                  $("#colStreetAddress").removeClass("col");
                                  $("#colStreetAddress").addClass("col-12");
                                  $("#colAddressDetails").removeClass("col");
                                  $("#colAddressDetails").addClass("col-12");
                                  $("#colBillStreetAddress").removeClass("col");
                                  $("#colBillStreetAddress").addClass("col-12");
                                  $("#colBillStreetAddressDetails").removeClass("col");
                                  $("#colBillStreetAddressDetails").addClass("col-12");
                                }
                              }
                              mediaQuery(x);
                              x.addListener(mediaQuery)
                            }, 10);
                          </script>
                          <style>
                            @media screen and (max-width: 420px) {
                              .preferredPaymentMethodSelect {
                                width: 215px !important;
                              }

                              .taxCodeSelect {
                                width: 215px !important;
                              }

                              .attachementsImage1 {
                                width: 200px !important;
                              }

                              .breakPhone {
                                display: block !important;
                              }
                            }
                          </style>
                          <div class="tab-content">
                            {{>vs1_tab_crm}}
                            {{>vs1_tab_address id="tab-4"}}
                            {{>vs1_tab_note id="tab-5"}}
                            {{>vs1_tab_invoicing id="tab-6"}}
                            {{>vs1_tab_attachments
                            divid="files_view"
                            id="tab-8"
                            uploadedFile=uploadedFile}}
                            {{>vs1_tab_custom_fields customfields=customfields id="tab-9"}}
                            {{>vs1_tab_tax id="tab-10"}}
                          </div>
                        </div>
                      </div>
                      <div class="d-xl-flex justify-content-between align-items-xl-center"
                        style="margin: 16px 0px 0px 0px;">
                        <button class="btn btn-success btnSave btn-auto-save" type="button"><i class="fa fa-save"
                            style="margin-right: 5px;"></i>Save</button>
                        <div>
                          <button class="btn btn-warning btnCustomerTask" type="button"><i class="fas fa-plus"
                              style="margin-right: 5px;"></i>Task</button>
                          <button class="btn btn-primary btnCustomerEmail" type="button"><i class="fas fa-plus"
                              style="margin-right: 5px;"></i>Email</button>
                          <button class="btn btn-success btnCustomerAppointment" type="button"><i class="fas fa-plus"
                              style="margin-right: 5px;"></i>Appointment</button>
                          <button class="btn btn-info btnCustomerQuote" type="button"><i class="fas fa-plus"
                              style="margin-right: 5px;"></i>Quote</button>
                          <button class="btn btn-warning btnCustomerSalesOrder" type="button"><i class="fas fa-plus"
                              style="margin-right: 5px;"></i>Sales Order</button>
                          <button class="btn btn-primary btnCustomerInvoice" type="button"><i class="fas fa-plus"
                              style="margin-right: 5px;"></i>Invoice</button>
                          <button class="btn btn-success btnCustomerRefund" type="button"><i class="fas fa-plus"
                              style="margin-right: 5px;"></i>Refund</button>
                        </div>
                        <div>
                          <a class="btn btn-danger" role="button" data-toggle="modal" href="#deleteCustomerModal"><i
                              class="fas fa-trash-alt" style="margin-right: 5px;"></i> Delete</a>
                          <button class="btn btn-secondary btnBack" type="button"><i class="fa fa-close"
                              style="margin-right: 5px;"></i>Cancel</button>
                        </div>
                      </div>
                      <div class="modal fade" role="dialog" tabindex="-1" id="deleteCustomerModal">
                        <div class="modal-dialog modal-dialog-centered" role="document">
                          <div class="modal-content">
                            <input type="hidden" style="width: 100%; display:none;" id="selectDeleteLineID"
                              name="selectDeleteLineID" readonly>
                            <div class="modal-header">
                              <h4>Delete</h4>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true"></span>
                              </button>
                            </div>
                            <div class="modal-body">
                              <p>Please confirm that you want to delete this Customer.</p>
                              <button class="btn btn-danger float-right btnDeleteCustomer" id="btnDeleteCustomer"
                                type="button">
                                <i class="fas fa-trash-alt" style="margin-right: 5px;"></i>Delete Customer
                              </button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    {{/if}}
                  </div>
                  <div class="tab-pane border rounded-0 tab-3" role="tabpanel" id="tab-3"
                    style="border-color: #ededed #00a3d3 #00a3d3 #00a3d3 !important;">
                    {{#if equals currentTab 'tab-3'}}
                    {{> export_refresh_import_print_display_button
                    tablename='tblCustomerJobDetailsList'
                    isNewMaker=true
                    newmaker="New Job"
                    modalname='addNewJobModal'
                    }}
                    <div class="row rowB" style="margin: 14px; margin-top: 0">
                      <div class="card-body rounded" style="padding: 0;">
                        {{> non_transactional_list tablename="tblCustomerJobDetailsList"}}
                      </div>
                    </div>
                    <!-- New Job Pop Up Start Here  -->
                    <div class="modal fade" role="dialog" tabindex="-1" id="addNewJobModal">
                      <div class="modal-dialog modal-lg modal-dialog-scrollable" role="document">
                        <div class="modal-content">
                          <div class="modal-header">
                            <h4 id="add-account-title" name="add-job-title">New
                              Job <a role="button" data-toggle="modal" href="#helpModal2"><label
                                  class="lblplay">PLAY</label><i class="far fa-play-circle"
                                  style="font-size: 20px;"></i></a></h4><button type="button" class="close"
                              data-dismiss="modal" aria-label="Close"><span aria-hidden="true"></span></button>
                          </div>
                          <div class="modal-body" style="background-color: #ededed;">
                            <input type="hidden" class="form-control" id="edtJobID" name="edtJobID"
                              style="display:none;">
                            <div>
                              <div class="row d-xl-flex flex-column justify-content-xl-center" style="margin: 12px; ">
                                <div class="col">
                                  <div class="row">
                                    {{#each item in tableheaderrecords}}
                                    {{> default_input
                                    label=item.label
                                    divClass=item.divClass
                                    id= item.id
                                    jobdivClass=item.jobdivClass
                                    isjobelement= true
                                    name=item.name
                                    readonly=item.readonly
                                    }}
                                    {{/each}}
                                  </div>
                                </div>
                                <div class="col" style="padding: 4px;margin-top: 16px;">
                                  <div>
                                    <ul class="nav nav-tabs nav-justified">
                                      <li class="nav-item" style=" cursor: pointer;"><a class="nav-link active"
                                          role="tab" data-toggle="tab" data-target="#tab-Job11">Address</a>
                                      </li>
                                      <li class="nav-item" style=" cursor: pointer;"><a class="nav-link" role="tab"
                                          data-toggle="tab" data-target="#tab-Job12">Notes</a>
                                      </li>
                                      <li class="nav-item" style=" cursor: pointer;"><a class="nav-link" role="tab"
                                          data-toggle="tab" data-target="#tab-Job13">Invoicing</a>
                                      </li>
                                      <li class="nav-item attachmentTabJobPOP" style=" cursor: pointer;">
                                        <a class="nav-link" role="tab" data-toggle="tab" data-target="#tab-Job14">
                                          {{#if attachmentCount}}<span
                                            id="attachment-countJob">{{attachmentCountJob}}</span>{{/if}}
                                          Attachments</a>
                                      </li>
                                      <!-- <li class="nav-item"><a class="nav-link" role="tab" data-toggle="tab" data-target="#tab-Job15">Custom Fields</a></li> -->
                                      <li class="nav-item" style=" cursor: pointer;"><a class="nav-link" role="tab"
                                          data-toggle="tab" data-target="#tab-Job16">Tax</a>
                                      </li>
                                    </ul>
                                    <div class="tab-content">
                                      {{>vs1_tab_address id="tab-Job11"}}
                                      {{>vs1_tab_note id="tab-Job12"}}
                                      {{>vs1_tab_invoicing id="tab-Job13"}}
                                      {{>vs1_tab_attachments
                                      divid="files_viewJobPOP"
                                      id="tab-Job14"
                                      uploadedFile=uploadedFileJob}}
                                      {{>vs1_tab_tax id="tab-Job16"}}
                                    </div>
                                  </div>
                                </div>

                              </div>

                              <!-- < End -->
                            </div>
                          </div>
                          <form></form>
                          <div class="modal-footer" style="background-color: #ededed;">
                            <div class="d-xl-flex justify-content-between align-items-xl-center"
                              style="margin: 16px 0 0 0; width:100%;">
                              <button class="btn btn-success btnSaveJob" type="button" style="min-width: 90px;"><i
                                  class="fa fa-save" style="margin: 4px;"></i>Save</button>
                              <button class="btn btn-secondary" type="button" data-dismiss="modal"
                                style="min-width: 90px;"><i class="fa fa-close" style="margin: 4px;"></i>Close</button>
                            </div>
                          </div>
                        </div>
                      </div>

                      <!-- Start Help Video Modal -->
                      <div class="modal fade" role="dialog" tabindex="-1" id="helpModal2">
                        <div class="modal-dialog" role="document" style="max-width: 670px!important;">
                          <div class="modal-content">
                            <div class="modal-header">
                              <h4 class="title-header">New Job</h4>
                              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                  aria-hidden="true"></span></button>
                            </div>
                            <div class="modal-body">
                              <video preload="none" id="myVideo" width="640" height="360" controls="" name="media"
                                style="border: solid 5px #999999f0; height: auto; outline: none;">
                                <source src="https://erphelpes.com/vs1videos/newjob.mp4" type="video/mp4">
                              </video>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!-- End Help Video Modal -->

                    </div>
                    <!-- New Job Pop Up Ends Here  -->
                    {{/if}}
                  </div>
                  {{/if}}
                  <div class="tab-pane border rounded-0 tab-1" role="tabpanel" id="tab-1"
                    style="border-color: #ededed #00a3d3 #00a3d3 #00a3d3 !important;">
                    {{#if equals currentTab 'tab-1'}}
                    <div class="row d-xl-flex flex-row justify-content-xl-center">
                      <div class="col float-left flex-grow-1 mb-4" style="margin-bottom: 0! important;">
                        <div class="btn-group float-left" style="margin: 14px; margin-bottom: 0;">
                          <button class="btn btn-primary btnRefreshTransaction" type="button"
                            style="background-color: #00A3D3; border-color: #00A3D3;"><i class="la la-lightbulb-o"
                              style="background-color: #00A3D3; border-color: #00A3D3;"></i>Refresh</button>
                        </div>
                      </div>
                      <div class="col">
                        <button class="btn btn-primary float-right printConfirmTransaction" type="button"
                          style="margin:14px; background-color: #00A3D3; border-color: #00A3D3;"><i class="fa fa-print"
                            style="padding-right: 5px; background-color: #00A3D3; border-color: #00A3D3;"></i>Print</button>
                        <button class="btn btn-primary export float-right" type="button"
                          style="margin: 14px; background-color: #00A3D3; border-color: #00A3D3;"
                          id="exportbtnTransaction" name="exportbtn"><i class="fas fa-file-export"
                            style="padding-right: 5px; background-color: #00A3D3; border-color: #00A3D3;"></i>Export</button>
                      </div>
                    </div>
                    <div class="d-flex justify-content-left" style="margin-left: 14px;">
                      <div style="width: 164px;">
                        {{> toggle_button className="chkGlobalSettings" id="customer_transctionList_appointments_toggle"
                        width="131px" for="customer_transctionList_appointments_toggle" displayName="Appointments"
                        isChecked=checkedAppointments}}
                      </div>
                      <div style="width: 154px;">
                        {{> toggle_button className="chkGlobalSettings" id="customer_transctionList_sales_orders_toggle"
                        width="131px" for="customer_transctionList_sales_orders_toggle" displayName="Sales"
                        isChecked=checkedSalesOrders}}
                      </div>
                    </div>
                    <div class="row rowB mt-2" style="margin: 14px; margin-top: 0">
                      <div class="card-body rounded" style="padding: 0;">
                        <!-- End -->
                        {{#if checkedAppointments}}
                        {{> non_transactional_list tablename="tblAppointmentsByCustomer" customerId=record.id}}
                        {{/if}}
                        {{#if checkedSales}}
                        <div class="mt-4">
                          {{> non_transactional_list tablename="tblSalesListByCustomer" customerName=record.company}}
                        </div>
                        {{/if}}
                      </div>
                    </div>
                    {{/if}}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    {{/if}}
  </div>

  <div class="modal fade" role="dialog" tabindex="-1" id="referenceLetterModal">
    <div class="modal-dialog modal-md modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header d-flex align-items-center">
          <h5 class="modal-title" id="chooseLetterLabel">Choose a reference letter</h5>
          <button class="btn btn-primary btnAddLetter" type="button">
            <i class="la la-lightbulb-o" style="padding-right: 5px;"></i>
            Add a template
          </button>
        </div>
        <div class="modal-body p-3" style="display: flex; flex-direction: column; align-items: stretch; gap: 20px">
          {{#each correspondence in correspondences}}
          <div>
            <input type="radio" name="refTemp" value="{{correspondence.Ref_Type}}" id="{{correspondence.Ref_Type}}"
              data-subject="{{correspondence.ReferenceTxt}}" data-memo="{{correspondence.MessageAsString}}">
            <label for="{{correspondence.label}}">
              {{correspondence.Ref_Type}}
            </label>
          </div>
          {{/each}}
        </div>
        <div class="modal-footer">
          <div class="d-flex align-items-center justify-content-end">
            {{> vs1_button
            color='success'
            classes='float-right btnSaveLetterTemp'
            type='button'
            id="save-correspondence"
            iconName='save'
            title='Save'
            }}
            {{> vs1_button
            color='secondary'
            classes='float-right btnSaveLetterTemp'
            type='button'
            id="save-correspondence"
            iconName='close'
            title='Close'
            }}
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="addLetterTemplateModal" role="dialog" tabindex="-1">
    <div class="modal-dialog modal-md modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addLetterTemplateLabel">Create a Letter Template</h5>
        </div>
        <div class="modal-body p-3" style="display: flex; flex-direction: column; align-items: stretch; gap: 20px">
          <input type="text" class="p-2" style="width: 100%; border-radius: 5px; border: 1px solid #d1d3ed"
            id="edtTemplateLbl" placeholder="Reference Letter Label" />
          <input type="text" class="p-2" style="width: 100%; border-radius: 5px; border: 1px solid #d1d3ed"
            id="edtTemplateSubject" placeholder="Subject" />
          <textarea type="text" class="p-2"
            style="width: 100%; height: 200px; resize: none; border-radius: 5px; border: 1px solid #d1d3ed"
            id="edtTemplateContent" placeholder="Enter Message Here"></textarea>
        </div>
        <div class="modal-footer">
          <div class="d-flex align-items-center justify-content-end">
            <button class="btn btn-success float-right btnSaveLetterTemp" id="save-correspondence" type="button"
              style="margin: 12px;"><i class="fa fa-save" style="margin-right: 5px;"></i>Save</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal"> <i class="fa fa-close"
                style="margin-right: 5px;"></i>Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" role="dialog" tabindex="-1" id="paymentMethodModal">
    {{> paymentmethodpop}}
  </div>

  <div class="modal fade" role="dialog" tabindex="-1" id="newPaymentMethodModal">
    {{> newpaymentmethodpop}}
  </div>

  <div class="modal fade" role="dialog" tabindex="-1" id="termsListModal">
    {{> termlistpop}}
  </div>

  <div class="modal fade" role="dialog" tabindex="-1" id="newTermsModal">
    {{> newtermspop}}
  </div>

  <div class="modal fade" role="dialog" tabindex="-1" id="clienttypeListModal">
    {{> clienttypepopup}}
  </div>

  <div class="modal fade" role="dialog" tabindex="-1" id="taxRateListModal">
    {{> taxratelistpop}}
  </div>
  <div class="modal fade" role="dialog" tabindex="-1" id="newTaxRateModal">
    {{> newtaxratepop}}
  </div>
  <div class="modal fade" role="dialog" tabindex="-1" id="statusPopModal">
    {{> statuspop}}
  </div>
  <div class="modal fade" role="dialog" tabindex="-1" id="newStatusPopModal">
    {{> newstatuspop}}
  </div>

  <!-- <div class="modal fade" role="dialog" tabindex="-1" id="customerTitlePopModal">
      {{> title_list_pop}}
    </div> -->

  <div class="modal fade" role="dialog" tabindex="-1" id="employeeListPOPModal">
    <div class="modal-dialog modal-xl modal-dialog-scrollable customerListModalInner" role="document"
      style="max-width: 90vw;">
      <div class="modal-content customerListContent">
        <div class="modal-header">
          <h4>Employee List</h4><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
              aria-hidden="true"></span></button>
        </div>
        <div class="modal-body mainCustomerModalBody appointmentCustomer" style="padding: 0px; overflow-x: hidden;">
          {{> employeelistpop tablename="tblEmployeelist1"}}
        </div>
        <div class="modal-footer">
          <button class="btn btn-primary btnSelectAllEmployee" type="button"
            style="background-color: #00A3D3; border-color: #00A3D3;">Select All Employees</button>

          <button class="btn btn-light" data-dismiss="modal" type="button">Close</button>
        </div>
      </div>
    </div>
  </div>

  {{> taskDetailModal}}
  {{> frmappointmentpop}}
  {{> newTaskModal}}


  <div class="modal fade customerListCrmModal" role="dialog" tabindex="-1" id="customerListCrmModal">
    <div class="modal-dialog modal-xl modal-dialog-scrollable customerListModalInner" role="document"
      style="max-width: 90vw;">
      <div class="modal-content customerListContent">
        <div class="modal-header">
          <h4>Contact List</h4><button type="button" class="close checkclose" data-dismiss="modal"
            aria-label="Close"><span aria-hidden="true"></span></button>
        </div>
        <div class="modal-body mainCustomerModalBody" style="padding: 0px; overflow-x: hidden;">
          <input type="hidden" style="width: 100%; display:none;" id="customerSelectLineID" name="customerSelectLineID"
            readonly>
          <div class="row">
            <div class="col-12 contactlistcol">
              {{> contactlistpop}}
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-light checkclose" data-dismiss="modal" type="button">Close</button>
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" role="dialog" tabindex="-1" id="employeeListCRMModal">
    <div class="modal-dialog modal-xl modal-dialog-scrollable customerListModalInner" role="document"
      style="max-width: 90vw;">
      <div class="modal-content customerListContent">
        <div class="modal-header">
          <h4>Employee List</h4><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
              aria-hidden="true"></span></button>
        </div>
        <div class="modal-body mainCustomerModalBody appointmentCustomer" style="padding: 0px; overflow-x: hidden;">
          {{> employeelistpop tablename="tblEmployeelist2"}}
        </div>
        <div class="modal-footer">
          <button class="btn btn-light" data-dismiss="modal" type="button">Close</button>
        </div>
      </div>
    </div>
  </div>

  {{> projectListPop}}

  <input type="hidden" id="assignedID" />
  <input type="hidden" id="contactID" />
  <input type="hidden" id="contactType" />
  <script>
    modalDraggable();
  </script>
</template>